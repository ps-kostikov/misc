#include <yandex/maps/sprav/model/storages/revision.h>
#include <yandex/maps/sprav/model/convert.h>
#include <yandex/maps/sprav/common/config.h>
#include <yandex/maps/sprav/common/stopwatch.h>
#include <yandex/maps/sprav/algorithms/datamodel/company.h>
#include <yandex/maps/sprav/algorithms/similarity/similarity.h>
#include <yandex/maps/sprav/algorithms/unification/email_unifier.h>
#include <yandex/maps/sprav/algorithms/unification/url_unifier.h>
#include <yandex/maps/sprav/algorithms/unification/address_unifier.h>

#include <yandex/maps/pgpool2/pgpool.h>
#include <yandex/maps/common/exception.h>

#include <boost/lexical_cast.hpp>

#include <iostream>
#include <fstream>
#include <string>
#include <algorithm>


namespace sprav = maps::sprav;
namespace model = maps::sprav::model;
namespace algorithms = maps::sprav::algorithms;


struct ReadSessionHolder {
    ReadSessionHolder(maps::pgpool2::ConnectionMgr& connMgr) :
        transaction(connMgr.readTransaction()),
        storage(new model::RevisionStorage(*transaction)),
        session(storage, model::Session::CachingPolicy::CacheAll)
    {}

    maps::pgpool2::PgTransaction transaction;
    std::shared_ptr<model::RevisionStorage> storage;
    model::Session session;
};


int main()
{
    std::cout << "hello" << std::endl;

    auto connectionManager =
        sprav::config::createConnectionManager(
            sprav::config::config(),
            sprav::config::ConnectionPoolProfile::Editor);
    ReadSessionHolder holder(*connectionManager);

    std::vector<model::ID> ids{
        353885,
        659799,
        920077,
        1184153,
        1291037,
        1388438,
        1641695,
        1647583,
        2247041,
        3513894,
        8003907,
        8004881,
        7953326,
        7953343,
        7956101,
        8004984,
        8004289,
        7955494,
        7955074,
        7956703,
        8002778,
        8002801,
        7955029,
        7956130,
        8002605,
        8003477,
        7952926,
        7952979,
        7952985,
        7952994,
        8005557,
        8005591,
        7952650,
        7952694,
        8005841,
        8009341,
        8009956,
        8008744,
        8008764,
        8008951,
        8008970,
        8006040,
        8006107,
        8006239,
        8009144,
        8010328,
        7953150,
        8006319,
        8006356,
        7952029,
        8006616,
        8009917,
        7955046,
        8004461,
        8004599,
        8008166,
        8002408,
        7955629,
        8007887,
        8007889,
        8007896,
        8007898,
        8007903,
        8007906,
        8007908,
        8007916,
        8007921,
        8007923,
        8007925,
        8007930,
        8007933,
        8007936,
        8007938,
        8007942,
        8007949,
        8007952,
        8007955,
        8007957,
        8007981,
        8007983,
        8007986,
        8007988,
        8007989,
        8007996,
        8008003,
        8008006,
        8008065,
        8008076,
        8008079,
        8008678,
        7951688,
        7951728,
        8005167,
        8002105,
        8002422,
        8004061,
        8005485,
        8002119,
        8003838,
        8010522,
        8010564,
        8006784,
        8010725,
        8010848,
        8002032,
        8005155,
        8005183,
        8010983,
        8006953,
        8011655,
        8011712,
        8009069,
        8002340,
        8012496,
        8012011,
        8012030,
        8012066,
        8008972,
        8009808,
        8010035,
        8010106,
        8012421,
        8008705,
        8009702,
        9013414,
        9066151,
        9813999,
        9771662,
        9955230,
        10514129,
        10513783,
        10570198,
        10567078,
        11266124,
        11267518,
        11265797,
        11317228,
        11265387,
        11266518,
        11267625,
        11267739,
        11267742,
        11317718,
        11316666,
        11316825,
        11317383,
        11317882,
        11318576,
        8010425,
        11317992,
        11317994,
        11318036,
        11268113,
        11268174,
        11317654,
        11319085,
        11316378,
        11316461,
        11316574,
        11319121,
        11268562,
        11268807,
        11268852,
        11464368,
        11514346,
        11269032,
        11318585,
        11412619,
        11463886,
        11513992,
        11267024,
        11269182,
        11265229,
        11413109,
        11413192,
        11464007,
        11515391,
        11515393,
        11515401,
        11319587,
        11414375,
        11463388,
        11463970,
        11414210,
        11513657,
        11513677,
        11513740,
        11513743,
        11513760,
        11513833,
        11516694,
        11317647,
        11464649,
        11513488,
        11316826,
        11414720,
        11414722,
        11464768,
        11464770,
        11464862,
        11514805,
        11515485,
        11315842,
        11315891,
        11315896,
        11315908,
        11415411,
        11415412,
        11315484,
        11315574,
        11465566,
        11515608,
        11516294,
        11516296,
        11516305,
        11516338,
        11413406,
        11465921,
        11516373,
        11516580,
        11315168,
        11315235,
        11465949,
        11516611,
        11516674,
        11516876,
        11516878,
        11516889,
        8010501,
        11411999,
        11413834,
        11413836,
        11413858,
        11463450,
        11514461,
        11514465,
        11514534,
        11514570,
        11514575,
        11514620,
        11514704,
        11514718,
        11514741,
        11514807,
        11514819,
        11514824,
        11516948,
        11517068,
        11517007,
        11517017,
        11517019,
        11517031,
        11517033,
        11517035,
        11517037,
        11517045,
        11517066,
        11517072,
        11517260,
        11411990,
        11464376,
        11462084,
        11462124,
        11462249,
        11462064,
        11461679,
        11461746,
        11620022,
        11461606,
        11461632,
        11715121,
        11621078,
        11713642,
        11719078,
        12729532,
        12879927,
        12728852,
        13594338,
        13594584,
        13696096,
        13597436,
        13599761,
        14298574,
        14604783,
        14790103,
        14799513,
        15045497,
        15048069,
        15619181,
        15718651,
        15965385,
        16020459,
        11318911,
        11319461,
        11319478,
        11319497,
        16383793,
        9063638,
        16329103,
        16382939,
        16329795,
        16329828,
        16381765,
        16477369,
        16478035,
        16381515,
        16477640,
        16328013,
        16330323,
        16379317,
        16482562,
        16326399,
        16327451,
        16328281,
        16326196,
        16326282,
        16326129,
        16326160,
        16476609,
        16379908,
        16579120,
        16482618,
        16482714,
        16382643,
        16483097,
        9011606,
        16377441,
        16483969,
        14792357,
        16383058,
        16578408,
        16484794,
        16578120,
        16579981,
        16580026,
        16580043,
        16580047,
        16580078,
        16485110,
        16485111,
        16483118,
        16485246,
        16482387,
        16482399,
        16483277,
        16479426,
        16483384,
        17137997,
        17138141,
        17138358,
        17138378,
        17138429,
        17138477,
        17138605,
        17138773,
        17138774,
        17137467,
        17137469,
        17137481,
        17137570,
        17137588,
        17137614,
        17137662,
        17137399,
        17137147,
        17137152,
        17137173,
        17137174,
        17137524,
        17138222,
        17139567,
        17136921,
        17137015,
        17139052,
        17139066,
        17139169,
        17086143,
        17086151,
        17086282,
        17086851,
        17139278,
        17139296,
        17139329,
        17139349,
        17086026,
        17086113,
        17086117,
        17140287,
        17140329,
        17140342,
        17140384,
        17140441,
        17137860,
        17140589,
        17140593,
        18093991,
        18095328,
        18095330,
        18099220,
        18099537,
        18098509,
        18098036,
        14790100,
        17136962,
        18000730,
        18098343,
        11719426,
        17999307,
        17138599,
        18101224,
        18094764,
        18096332,
        17086112,
        18100539,
        18094618,
        11465024,
        18095299,
        18099141,
        18101952,
        18094276,
        17140331,
        18093652,
        18092996,
        18103478,
        18290820,
        18103926,
        17140534,
        18100906,
        17137857,
        18100113,
        18100116,
        18100771,
        18101629,
        18103860,
        18891040,
        353149,
        18840089,
        18892260,
        20806456,
        21263607,
        21711733,
        23924744,
        23927894,
        23976523,
        23981542,
        24427510,
        24979433,
        25429001,
        25430152,
        26388986,
        26884981,
        26885420,
        27436130,
        27386307,
        27839229,
        27938721,
        27931974,
        28332055,
        28330849,
        28633181,
        28486177,
        28684544,
        28537630,
        28840572,
        30139538,
        30142398,
        30140266,
        30142206,
        30192084,
        25429412,
        30141740,
        30137887,
        30241699,
        30242547,
        30242563,
        30242778,
        30138201,
        30191698,
        30137576,
        23924745,
        30137717,
        30137814,
        30241586,
        30241596,
        30241905,
        30242008,
        30242017,
        30242020,
        30242976,
        16327454,
        30137533,
        30137563,
        30143285,
        30143323,
        30241647,
        11269133,
        30137321,
        30190840,
        30143924,
        16384778,
        30142325,
        30142330,
        30193060,
        23979238,
        30144235,
        30193144,
        30193145,
        30193159,
        30241602,
        17137864,
        30141219,
        30193682,
        30193701,
        30140652,
        30193809,
        30193810,
        30194149,
        30194183,
        30593877,
        30594440,
        31888568,
        32079489,
        32003686,
        32385261,
        32185269,
        32633384,
        32739020,
        33851775,
        33849263,
        34100886,
        34247558,
        34444401,
        34600929,
        35110532,
        35110748,
        35160355,
        35608757,
        36008144,
        36056237,
        36309678,
        36309807,
        38599451,
        38598095,
        39303318,
        39454930,
        39754428,
        39608076,
        39705750,
        39810270,
        40509422,
        40509836,
        40403850,
        40256790,
        40509962,
        45258600,
        45258833,
        45258870,
        45155104,
        28435304,
        45154136,
        45155727,
        45763326,
        24431879,
        45762555,
        45759781,
        45960843,
        45963332,
        45959735,
        32382899,
        45961653,
        46954356,
        47054379,
        47210390,
        47257634,
        47415462,
        47965888,
        47722099,
        47968084,
        48160358,
        48161536,
        48223006,
        48221737,
        48066010,
        39609645,
        49857785,
        49859092,
        50855819,
        50957866,
        51109172,
        51655299,
        51703232,
        52106881,
        52101230,
        52515923,
        52757636,
        52811184,
        53266860,
        53265015,
        53505134,
        53514539,
        53753348,
        53453730,
        53757980,
        53751216,
        53956327,
        54156579,
        53957366,
        54408001,
        54409738,
        53760067,
        36007935,
        54900373,
        18096580,
        16327954,
        54903603,
        54899091,
        54898995,
        54898997,
        53267047,
        55053156,
        36008145,
        55101156,
        55549134,
        55999176,
        55999437,
        55999451,
        55848222,
        55944789,
        56194730,
        56600402,
        57097622,
        57097635,
        57098420,
        57048620,
        57047943,
        57097549,
        57298534,
        30242511,
        30243574,
        30243579,
        57198604,
        57297649,
        57297973,
        57476096,
        57294644,
        57599028,
        48160743,
        57648346,
        58148141,
        58148610,
        8012160,
        58150757,
        58150987,
        58348274,
        58348433,
        58348436,
        58348437,
        58348865,
        58544594,
        58544641,
        58545286,
        58846812,
        58849638,
        58995275,
        58996675,
        58945429,
        58994765,
        59097174,
        59346016,
        59345610,
        59347922,
        59594873,
        59592218,
        59593490,
        59646401,
        59645318,
        17086152,
        63196397,
        63349002,
        63602304,
        63796304,
        64102921,
        64344624,
        28331211,
        65153400,
        65305044,
        35354607,
        65547953,
        65598041,
        65747238,
        65547986,
        65945386,
        66147411,
        66347569,
        66696571,
        66496863,
        66697801,
        66945634,
        16328076,
        67697216,
        67695326,
        67899033,
        67899482,
        68298390,
        68595993,
        68698265,
        68597816,
        68903377,
        69150874,
        69401628,
        69955954,
        69853723,
        70759971,
        70760034,
        70760095,
        70901883,
        70902541,
        70903425,
        70903470,
        70760220,
        70760982,
        70901144,
        70904504,
        70902706,
        70904579,
        71001745,
        71001839,
        71001927,
        71002238,
        70905052,
        70902114,
        71002388,
        70901802,
        71002858,
        71251828,
        45960898,
        71055851,
        71056850,
        71056857,
        71252648,
        71005008,
        71056782,
        71254969,
        71255134,
        71255863,
        71259005,
        71206875,
        71252777,
        71258260,
        71259637,
        71501993,
        71501083,
        71501334,
        71508079,
        71506577,
        71607795,
        71509426,
        71755802,
        71606929,
        71705431,
        71855949,
        71755364,
        72107101,
        72156918,
        72358069,
        72305630,
        72507885,
        72508599,
        72558078,
        72459069,
        72559075,
        72611342,
        72710111,
        72710030,
        72809325,
        73409855,
        73558489,
        73658493,
        73756490,
        73857454,
        74056352,
        74106382,
        74056260,
        74301251,
        74302786,
        74303873,
        74306460,
        74356178,
        74354461,
        74354816,
        74655658,
        74801476,
        74655286,
        74657033,
        74855358,
        74656957,
        74803062,
        74803087,
        74854833,
        75051476,
        75051478,
        74905268,
        74904664,
        75051698,
        75051939,
        75299942,
        30193062,
        75054361,
        75301278,
        75305133,
        75153992,
        75302982,
        75402243,
        75654439,
        75554274,
        75554126,
        75804395,
        75902814,
        75903284,
        76002803,
        75901504,
        76054249,
        76055128,
        76054741,
        76152295,
        76352145,
        76499258,
        76352383,
        76498815,
        76501337,
        76502694,
        76699506,
        76552160,
        77053929,
        77302372,
        77103113,
        77653986,
        77901749,
        77847246,
        78392138,
        78395186,
        11462733,
        78394418,
        77795341,
        78939993,
        79195139,
        79194678,
        79044876,
        79044552,
        79194243,
        353150,
        79046253,
        79095673,
        40256224,
        79043957,
        79044092,
        79096281,
        79096682,
        79342590,
        79343083,
        70757809,
        79043859,
        79043942,
        79045222,
        79043913,
        79196074,
        79196341,
        79196900,
        79094396,
        79094310,
        79094186,
        79094187,
        79096687,
        79197628,
        79197825,
        70759426,
        79446688,
        51705696,
        79447705,
        79445118,
        79596260,
        79597685,
        79699310,
        79696379,
        79846281,
        79846389,
        57598693,
        79846266,
        79843967,
        79844068,
        79844134,
        79845486,
        79845535,
        79848556,
        79848765,
        79850242,
        79850274,
        79850789,
        79845017,
        79845090,
        79846424,
        79847260,
        79848370,
        79848393,
        79849039,
        79847295,
        79848322,
        79848710,
        79848763,
        79850004,
        79851048,
        79849930,
        79850324,
        79850695,
        79850708,
        79851384,
        80094062,
        80095688,
        80095905,
        80094091,
        80197118,
        80098503,
        80147742,
        33850035,
        80341819,
        80496485,
        80647738,
        81496654,
        52809990,
        82251470,
        82496594,
        82503548,
        83053681,
        83052486,
        83150210,
        83508994,
        83906408,
        84158167,
        84654404,
        85201855,
        85700907,
        70761123,
        72711310,
        86209375,
        86204777,
        86309095,
        86557336,
        86659607,
        87150597,
        87007364,
        87100862,
        87447813,
        87949056,
        88649624,
        88704585,
        27386061,
        89206468,
        78942084,
        27386065,
        89547766,
        70758404,
        90233175,
        90282195,
        90282755,
        90482891,
        80198131,
        90533279,
        90334306,
        90334197,
        90334223,
        90335880,
        90533311,
        90583977,
        91555832,
        91556380,
        91556592,
        91555990,
        91556278,
        91556406,
        91504553,
        91503114,
        91505448,
        91502714,
        91901178,
        91951057,
        92087792,
        92833234,
        92684031,
        93134851,
        93134155,
        95602231,
        95653024,
        95601317,
        95600936,
        96502175,
        96689969,
        96688945,
        96996437,
        96998398,
        97247988,
        97245073,
        97344520,
        97444837,
        97589196,
        98037085,
        98964903,
        99214756,
        99416662,
        99421564,
        99763418,
        80197901,
        100052383,
        100695311,
    };
    ids.resize(100);
    holder.session.loadCompany(ids);
    return 0;
}